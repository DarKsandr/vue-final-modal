{"version":3,"file":"VueFinalModal.esm.js","sources":["../src/utils/transitionState.js","../src/utils/focusTrap.js","../src/utils/index.js","../src/utils/dom.js","../src/utils/dragResize.js","../src/utils/bodyScrollLock.js","../src/VueFinalModal.vue","../src/VueFinalModal.vue?vue&type=template&id=72c09f54&lang.js","../../../node_modules/.pnpm/style-inject@0.3.0/node_modules/style-inject/dist/style-inject.es.js","../src/ModalsContainer.vue","../src/ModalsContainer.vue?vue&type=template&id=437c4752&lang.js","../src/modalInstance.js","../src/utils/swipeable.js","../src/hoc/VBottomSheet.vue","../src/hoc/VFullScreen.vue"],"sourcesContent":["import { ref } from 'vue'\n\nexport const TransitionState = {\n  Enter: 'enter',\n  Entering: 'entering',\n  Leave: 'leave',\n  Leaving: 'leavng'\n}\n\nexport const useTransitionState = () => {\n  const state = ref(null)\n\n  const listeners = {\n    beforeEnter() {\n      state.value = TransitionState.Entering\n    },\n    afterEnter() {\n      state.value = TransitionState.Enter\n    },\n    beforeLeave() {\n      state.value = TransitionState.Leaving\n    },\n    afterLeave() {\n      state.value = TransitionState.Leave\n    }\n  }\n\n  return {\n    state,\n    listeners\n  }\n}\n","import { watch } from 'vue'\nimport { TransitionState } from './transitionState'\n\n// stolen from vue-js-modal\n\nconst FOCUSABLE_ELEMENTS_QUERY =\n  'button:not([disabled]), ' +\n  'select:not([disabled]), ' +\n  'a[href]:not([disabled]), ' +\n  'area[href]:not([disabled]), ' +\n  '[contentEditable=\"\"]:not([disabled]), ' +\n  '[contentEditable=\"true\"]:not([disabled]), ' +\n  '[contentEditable=\"TRUE\"]:not([disabled]), ' +\n  'textarea:not([disabled]), ' +\n  'iframe:not([disabled]), ' +\n  'input:not([disabled]), ' +\n  'summary:not([disabled]), ' +\n  '[tabindex]:not([tabindex=\"-1\"])'\n\nconst isTabPressed = event => {\n  return event.key === 'Tab' || event.keyCode === 9\n}\n\nconst querySelectorAll = (element, selector) => {\n  return [...(element.querySelectorAll(selector) || [])]\n}\n\nconst queryFocusableElements = element => {\n  return querySelectorAll(element, FOCUSABLE_ELEMENTS_QUERY)\n}\n\nconst isFocused = element => {\n  return element == document.activeElement\n}\n\nconst isNothingFocused = () => {\n  return !document.activeElement\n}\n\nclass FocusTrap {\n  constructor() {\n    this.root = null\n    this.elements = []\n\n    this.onKeyDown = this.onKeyDown.bind(this)\n  }\n\n  /**\n   * Get last Element on the trap\n   *\n   * @return {HTMLElement | null} element\n   */\n  get lastElement() {\n    return this.elements[this.elements.length - 1] || null\n  }\n\n  /**\n   * Get first Element on the trap\n   *\n   * @return {HTMLElement | null} element\n   */\n  get firstElement() {\n    return this.elements[0] || null\n  }\n\n  /**\n   * Get whether the trap is enabled\n   *\n   * @return {boolean} isEnabled\n   */\n  get isEnabled() {\n    return !!this.root\n  }\n\n  onKeyDown(event) {\n    if (!isTabPressed(event)) {\n      return\n    }\n\n    // SHIFT + TAB\n    if (event.shiftKey) {\n      if (isFocused(this.firstElement)) {\n        this.lastElement.focus()\n        event.preventDefault()\n      }\n      return\n    }\n\n    // TAB\n    if (isNothingFocused() || isFocused(this.lastElement)) {\n      this.firstElement.focus()\n      event.preventDefault()\n      return\n    }\n  }\n\n  /**\n   * Enable focus trap\n   *\n   * @param {HTMLElement} root - the focus trap root element\n   */\n  enable(root) {\n    if (!root) {\n      return\n    }\n\n    this.root = root\n    this.elements = queryFocusableElements(this.root)\n\n    this.root.addEventListener('keydown', this.onKeyDown)\n  }\n\n  /**\n   * Disable focus trap\n   */\n  disable() {\n    this.root.removeEventListener('keydown', this.onKeyDown)\n    this.root = null\n  }\n}\n\n/**\n * @type {FocusTrap | null}\n */\nlet focusTrap = null\n\n/**\n * Get FocusTrap focusTrap\n *\n * @returns {FocusTrap} focusTrap\n */\nexport function useFocusTrap({ props, vfmContainer, modalTransitionState }) {\n  if (focusTrap == null) {\n    focusTrap = new FocusTrap()\n  }\n\n  watch(modalTransitionState, state => {\n    switch (state) {\n      case TransitionState.Enter:\n        if (props.focusRetain || props.focusTrap) {\n          vfmContainer.value.focus()\n        }\n        props.focusTrap && focusTrap.enable(vfmContainer.value)\n        break\n      case TransitionState.Leaving:\n        if (focusTrap.enabled) {\n          focusTrap.disable()\n        }\n        break\n    }\n  })\n\n  return { focusTrap }\n}\n","export const noop = () => {}\n","import { noop } from './index'\n\nexport const looseFocus = () => {\n  const element = document.activeElement\n  if (element && element !== document.body) {\n    element.blur()\n  }\n}\n\nexport const getPosition = e => {\n  const { clientX: x, clientY: y } = e.targetTouches ? e.targetTouches[0] : e\n  return { x, y }\n}\n\nexport const pointerType = {\n  down: {\n    pc: 'mousedown',\n    m: 'touchstart'\n  },\n  move: {\n    pc: 'mousemove',\n    m: 'touchmove'\n  },\n  up: {\n    pc: 'mouseup',\n    m: 'touchend'\n  }\n}\n\nexport const addListener = (type, el, callback) => {\n  el && el.addEventListener(pointerType[type].pc, callback)\n  el && el.addEventListener(pointerType[type].m, callback, { passive: false })\n}\nexport const removeListener = (type, el, callback) => {\n  el && el.removeEventListener(pointerType[type].pc, callback)\n  el && el.removeEventListener(pointerType[type].m, callback)\n}\n\nexport function checkPassiveEventSupport(document) {\n  if (!document) return false\n  let supportsPassive = false\n  const optionsBlock = {\n    get passive() {\n      supportsPassive = true\n      return false\n    }\n  }\n  document.addEventListener('x', noop, optionsBlock)\n  document.removeEventListener('x', noop)\n  return supportsPassive\n}\n","import { watch, ref, nextTick } from 'vue'\nimport { TransitionState } from './transitionState'\nimport { addListener, removeListener, getPosition } from './dom'\n\nconst resizeCursor = {\n  t: 'ns-resize',\n  tr: 'nesw-resize',\n  r: 'ew-resize',\n  br: 'nwse-resize',\n  b: 'ns-resize',\n  bl: 'nesw-resize',\n  l: 'ew-resize',\n  tl: 'nwse-resize'\n}\n\nexport const setStyle = (el, key, value) => {\n  const cacheStyle = el.style[key]\n  el.style[key] = value\n  return () => {\n    el.style[key] = cacheStyle\n  }\n}\n\nexport const capitalize = s => {\n  return s.charAt(0).toUpperCase() + s.slice(1)\n}\n\nexport const clamp = (min, num, max) => {\n  if (typeof min !== 'number') {\n    min = Math.min(num, max) || num\n  }\n  if (typeof max !== 'number') {\n    max = Math.max(num, min)\n  }\n  return Math.min(Math.max(num, min), max)\n}\n\nexport const trimPx = distance => {\n  return (distance && Number(distance.replace(/px$/, ''))) || 0\n}\n\nexport const validDragElement = (e, el, dragSelector) => {\n  if (dragSelector === '') return true\n  const list = [...el.querySelectorAll(dragSelector)]\n  return list.includes(e.target)\n}\n\nexport function useDragResize({\n  props,\n  visible,\n  vfmContainer,\n  vfmContent,\n  vfmResize,\n  modalTransitionState,\n  onEvent = () => {}\n}) {\n  const resizeVisible = ref(false)\n  const state = ref(null)\n  const dragResizeStyle = ref({})\n\n  watch(modalTransitionState, val => {\n    switch (val) {\n      case TransitionState.Enter:\n        props.drag && addDragDown()\n        props.resize && addResizeDown()\n        break\n      case TransitionState.Leave:\n        if (!props.keepChangedStyle) {\n          dragResizeStyle.value = {}\n        }\n        break\n    }\n  })\n\n  watch(\n    () => props.drag,\n    val => {\n      if (visible.value) {\n        val ? addDragDown() : removeDragDown()\n      }\n    }\n  )\n\n  watch(\n    () => props.resize,\n    val => {\n      if (visible.value) {\n        val ? addResizeDown() : removeResizeDown()\n      }\n    }\n  )\n\n  watch(\n    () => props.keepChangedStyle,\n    val => {\n      if (!val) {\n        dragResizeStyle.value = {}\n      }\n    }\n  )\n\n  function pointerDown(e) {\n    e.stopPropagation()\n    const STATE_RESIZE = 'resize'\n    const STATE_DRAG = 'drag'\n    const direction = e.target.getAttribute('direction')\n    let _state\n    if (direction) {\n      _state = STATE_RESIZE\n    } else if (validDragElement(e, vfmContent.value, props.dragSelector)) {\n      _state = STATE_DRAG\n    } else {\n      return\n    }\n    state.value = `${_state}:start`\n    onEvent?.(e)\n    const down = getPosition(e)\n    const rectContainer = vfmContainer.value.getBoundingClientRect()\n    const rectContent = vfmContent.value.getBoundingClientRect()\n    const isAbsolute = window.getComputedStyle(vfmContent.value).position === 'absolute'\n    const position = {\n      top: trimPx(dragResizeStyle.value.top),\n      left: trimPx(dragResizeStyle.value.left)\n    }\n    const limit = (() => {\n      if (props.fitParent) {\n        const limit = {\n          absolute() {\n            return {\n              minTop: 0,\n              minLeft: 0,\n              maxTop: rectContainer.height - rectContent.height,\n              maxLeft: rectContainer.width - rectContent.width\n            }\n          },\n          relative() {\n            return {\n              minTop: position.top + rectContainer.top - rectContent.top,\n              minLeft: position.left + rectContainer.left - rectContent.left,\n              maxTop: position.top + rectContainer.bottom - rectContent.bottom,\n              maxLeft: position.left + rectContainer.right - rectContent.right\n            }\n          }\n        }\n        return isAbsolute ? limit.absolute() : limit.relative()\n      } else {\n        return {}\n      }\n    })()\n    const resetBodyCursor = _state === STATE_RESIZE && setStyle(document.body, 'cursor', resizeCursor[direction])\n\n    const moving = e => {\n      // onPointerMove\n      e.stopPropagation()\n      state.value = `${_state}:move`\n      onEvent?.(e)\n      const move = getPosition(e)\n      let offset = {\n        x: move.x - down.x,\n        y: move.y - down.y\n      }\n      if (_state === STATE_RESIZE) {\n        offset = getResizeOffset(direction, offset, rectContainer, rectContent, isAbsolute)\n      }\n\n      let top\n      let left\n      if (isAbsolute) {\n        top = rectContent.top - rectContainer.top + offset.y\n        left = rectContent.left - rectContainer.left + offset.x\n      } else {\n        top = position.top + offset.y\n        left = position.left + offset.x\n      }\n      if (_state === STATE_DRAG && props.fitParent) {\n        top = clamp(limit.minTop, top, limit.maxTop)\n        left = clamp(limit.minLeft, left, limit.maxLeft)\n      }\n      const style = {\n        position: 'relative',\n        top: top + 'px',\n        left: left + 'px',\n        margin: 'unset',\n        touchAction: 'none',\n        ...(isAbsolute && {\n          position: 'absolute',\n          transform: 'unset',\n          width: rectContent.width + 'px',\n          height: rectContent.height + 'px'\n        }),\n        ...(offset.width && { width: offset.width + 'px' }),\n        ...(offset.height && { height: offset.height + 'px' })\n      }\n\n      dragResizeStyle.value = {\n        ...dragResizeStyle.value,\n        ...style\n      }\n    }\n    const end = e => {\n      // onPointerUp\n      e.stopPropagation()\n      if (_state === STATE_RESIZE) {\n        resetBodyCursor && resetBodyCursor()\n      }\n      // Excute onMouseupContainer before trigger onEvent\n      setTimeout(() => {\n        state.value = `${_state}:end`\n        onEvent?.(e)\n      })\n      removeListener('move', document, moving)\n      removeListener('up', document, end)\n    }\n    addListener('move', document, moving)\n    addListener('up', document, end)\n  }\n  function addDragDown() {\n    addListener('down', vfmContent.value, pointerDown)\n    dragResizeStyle.value.touchAction = 'none'\n  }\n  function removeDragDown() {\n    removeListener('down', vfmContent.value, pointerDown)\n  }\n  function addResizeDown() {\n    resizeVisible.value = true\n    nextTick(() => {\n      addListener('down', vfmResize.value, pointerDown)\n    })\n  }\n  function removeResizeDown() {\n    removeListener('down', vfmResize.value, pointerDown)\n    resizeVisible.value = false\n  }\n  function getResizeOffset(direction, offset, rectContainer, rectContent, isAbsolute) {\n    const setOffset = dir => {\n      let offsetAxis = offset[dir.axis]\n      offsetAxis = props.fitParent ? clamp(dir.min, offsetAxis, dir.max) : offsetAxis\n      let edge = clamp(dir.minEdge, dir.getEdge(offsetAxis), dir.maxEdge)\n      offsetAxis = dir.getOffsetAxis(edge, isAbsolute)\n      return {\n        [dir.edgeName]: edge,\n        [dir.axis]: offsetAxis\n      }\n    }\n\n    const getDirectionInfo = (position, edgeName, axis, isPositive) => {\n      const rectContentEdge = rectContent[edgeName]\n      const positionOffset = rectContainer[position] - rectContent[position]\n      const EdgeName = capitalize(edgeName)\n      return {\n        axis,\n        edgeName,\n        min: isPositive ? positionOffset : -rectContentEdge,\n        max: isPositive ? rectContentEdge : positionOffset,\n        minEdge: props[`min${EdgeName}`],\n        maxEdge: props[`max${EdgeName}`],\n        getEdge: offsetAxis => rectContent[edgeName] - offsetAxis * (isPositive ? 1 : -1),\n        getOffsetAxis: (edge, isAbsolute) => {\n          const offsetAxis = rectContent[edgeName] - edge\n          if (isAbsolute) {\n            return isPositive ? offsetAxis : 0\n          } else {\n            return ((isPositive ? 1 : -1) * offsetAxis) / 2\n          }\n        }\n      }\n    }\n\n    const directions = {\n      t: ['top', 'height', 'y', true],\n      b: ['bottom', 'height', 'y', false],\n      l: ['left', 'width', 'x', true],\n      r: ['right', 'width', 'x', false]\n    }\n\n    let _offset = { x: 0, y: 0 }\n    direction.split('').forEach(dir => {\n      const directionInfo = getDirectionInfo(...directions[dir])\n      _offset = {\n        ..._offset,\n        ...setOffset(directionInfo)\n      }\n    })\n    return _offset\n  }\n\n  return {\n    resizeVisible,\n    state,\n    dragResizeStyle,\n    removeDragDown,\n    removeResizeDown\n  }\n}\n","import { watch, nextTick, onBeforeUnmount } from 'vue'\nimport { TransitionState } from './transitionState'\n\n// stolen from body-scroll-lock\n\n// Older browsers don't support event options, feature detect it.\nlet hasPassiveEvents = false\nif (typeof window !== 'undefined') {\n  const passiveTestOptions = {\n    get passive() {\n      hasPassiveEvents = true\n      return undefined\n    }\n  }\n  window.addEventListener('testPassive', null, passiveTestOptions)\n  window.removeEventListener('testPassive', null, passiveTestOptions)\n}\n\nconst isIosDevice =\n  typeof window !== 'undefined' &&\n  window.navigator &&\n  window.navigator.platform &&\n  (/iP(ad|hone|od)/.test(window.navigator.platform) ||\n    (window.navigator.platform === 'MacIntel' && window.navigator.maxTouchPoints > 1))\n\nlet locks = []\nlet documentListenerAdded = false\nlet clientY = 0\nlet initialClientY = -1\nlet previousBodyOverflowSetting\nlet previousBodyPaddingRight\n\nconst hasScrollbar = el => {\n  if (!el || el.nodeType !== Node.ELEMENT_NODE) return false\n\n  const style = window.getComputedStyle(el)\n  return ['auto', 'scroll'].includes(style.overflowY) && el.scrollHeight > el.clientHeight\n}\n\nconst shouldScroll = (el, delta) => {\n  if (el.scrollTop === 0 && delta < 0) return false\n  if (el.scrollTop + el.clientHeight + delta >= el.scrollHeight && delta > 0) return false\n  return true\n}\n\nconst composedPath = el => {\n  const path = []\n  while (el) {\n    path.push(el)\n    if (el.classList.contains('vfm')) return path\n    el = el.parentElement\n  }\n  return path\n}\n\nconst hasAnyScrollableEl = (el, delta) => {\n  let hasAnyScrollableEl = false\n  const path = composedPath(el)\n  path.forEach(el => {\n    if (hasScrollbar(el) && shouldScroll(el, delta)) {\n      hasAnyScrollableEl = true\n    }\n  })\n  return hasAnyScrollableEl\n}\n\n// returns true if `el` should be allowed to receive touchmove events.\nconst allowTouchMove = el => locks.some(() => hasAnyScrollableEl(el, -clientY))\n\nconst preventDefault = rawEvent => {\n  const e = rawEvent || window.event\n\n  // For the case whereby consumers adds a touchmove event listener to document.\n  // Recall that we do document.addEventListener('touchmove', preventDefault, { passive: false })\n  // in disableBodyScroll - so if we provide this opportunity to allowTouchMove, then\n  // the touchmove event on document will break.\n  if (allowTouchMove(e.target)) {\n    return true\n  }\n  // Do not prevent if the event has more than one touch (usually meaning this is a multi touch gesture like pinch to zoom).\n  if (e.touches.length > 1) return true\n\n  if (e.preventDefault) e.preventDefault()\n\n  return false\n}\n\nconst setOverflowHidden = options => {\n  // If previousBodyPaddingRight is already set, don't set it again.\n  if (previousBodyPaddingRight === undefined) {\n    const reserveScrollBarGap = !!options && options.reserveScrollBarGap === true\n    const scrollBarGap = window.innerWidth - document.documentElement.clientWidth\n\n    if (reserveScrollBarGap && scrollBarGap > 0) {\n      const computedBodyPaddingRight = parseInt(getComputedStyle(document.body).getPropertyValue('padding-right'), 10)\n      previousBodyPaddingRight = document.body.style.paddingRight\n      document.body.style.paddingRight = `${computedBodyPaddingRight + scrollBarGap}px`\n    }\n  }\n  // If previousBodyOverflowSetting is already set, don't set it again.\n  if (previousBodyOverflowSetting === undefined) {\n    previousBodyOverflowSetting = document.body.style.overflow\n    document.body.style.overflow = 'hidden'\n  }\n}\n\nconst restoreOverflowSetting = () => {\n  if (previousBodyPaddingRight !== undefined) {\n    document.body.style.paddingRight = previousBodyPaddingRight\n\n    // Restore previousBodyPaddingRight to undefined so setOverflowHidden knows it\n    // can be set again.\n    previousBodyPaddingRight = undefined\n  }\n\n  if (previousBodyOverflowSetting !== undefined) {\n    document.body.style.overflow = previousBodyOverflowSetting\n\n    // Restore previousBodyOverflowSetting to undefined\n    // so setOverflowHidden knows it can be set again.\n    previousBodyOverflowSetting = undefined\n  }\n}\n// https://developer.mozilla.org/en-US/docs/Web/API/Element/scrollHeight#Problems_and_solutions\nconst isTargetElementTotallyScrolled = targetElement =>\n  targetElement ? targetElement.scrollHeight - targetElement.scrollTop <= targetElement.clientHeight : false\n\nconst handleScroll = (event, targetElement) => {\n  clientY = event.targetTouches[0].clientY - initialClientY\n\n  if (allowTouchMove(event.target)) {\n    return false\n  }\n\n  if (targetElement && targetElement.scrollTop === 0 && clientY > 0) {\n    // element is at the top of its scroll.\n    return preventDefault(event)\n  }\n\n  if (isTargetElementTotallyScrolled(targetElement) && clientY < 0) {\n    // element is at the bottom of its scroll.\n    return preventDefault(event)\n  }\n\n  event.stopPropagation()\n  return true\n}\n\nexport const disableBodyScroll = (targetElement, options) => {\n  // targetElement must be provided\n  if (!targetElement) {\n    // eslint-disable-next-line no-console\n    console.error(\n      'disableBodyScroll unsuccessful - targetElement must be provided when calling disableBodyScroll on IOS devices.'\n    )\n    return\n  }\n\n  // disableBodyScroll must not have been called on this targetElement before\n  if (locks.some(lock => lock.targetElement === targetElement)) {\n    return\n  }\n\n  const lock = {\n    targetElement,\n    options: options || {}\n  }\n\n  locks = [...locks, lock]\n\n  if (isIosDevice) {\n    targetElement.ontouchstart = event => {\n      if (event.targetTouches.length === 1) {\n        // detect single touch.\n        initialClientY = event.targetTouches[0].clientY\n      }\n    }\n    targetElement.ontouchmove = event => {\n      if (event.targetTouches.length === 1) {\n        // detect single touch.\n        handleScroll(event, targetElement)\n      }\n    }\n\n    if (!documentListenerAdded) {\n      document.addEventListener('touchmove', preventDefault, hasPassiveEvents ? { passive: false } : undefined)\n      documentListenerAdded = true\n    }\n  } else {\n    setOverflowHidden(options)\n  }\n}\n\nexport const enableBodyScroll = targetElement => {\n  if (!targetElement) {\n    // eslint-disable-next-line no-console\n    console.error(\n      'enableBodyScroll unsuccessful - targetElement must be provided when calling enableBodyScroll on IOS devices.'\n    )\n    return\n  }\n\n  locks = locks.filter(lock => lock.targetElement !== targetElement)\n\n  if (isIosDevice) {\n    targetElement.ontouchstart = null\n    targetElement.ontouchmove = null\n\n    if (documentListenerAdded && locks.length === 0) {\n      document.removeEventListener('touchmove', preventDefault, hasPassiveEvents ? { passive: false } : undefined)\n      documentListenerAdded = false\n    }\n  } else if (!locks.length) {\n    restoreOverflowSetting()\n  }\n}\n\nexport function useLockScroll({ props, vfmContainer, modalTransitionState }) {\n  watch(() => props.lockScroll, handleLockScroll)\n\n  watch(modalTransitionState, state => {\n    if (state === TransitionState.Leave) {\n      enable()\n    }\n  })\n\n  onBeforeUnmount(() => {\n    enable()\n  })\n\n  function handleLockScroll() {\n    if (!props.modelValue) return\n    nextTick(() => {\n      props.lockScroll ? disable() : enable()\n    })\n  }\n\n  function enable() {\n    props.lockScroll && vfmContainer.value && enableBodyScroll(vfmContainer.value)\n  }\n\n  function disable() {\n    vfmContainer.value &&\n      disableBodyScroll(vfmContainer.value, {\n        reserveScrollBarGap: true,\n        allowTouchMove: el => {\n          while (el && el !== document.body) {\n            if (el.getAttribute('vfm-scroll-lock-ignore') !== null) {\n              return true\n            }\n\n            el = el.parentElement\n          }\n        }\n      })\n  }\n\n  return { handleLockScroll }\n}\n","<template>\n  <teleport :to=\"teleportTo\" :disabled=\"!teleportTo\">\n    <div\n      v-if=\"displayDirective !== 'if' || visible\"\n      v-show=\"displayDirective !== 'show' || visible\"\n      v-bind=\"$attrs\"\n      ref=\"root\"\n      :style=\"bindStyle\"\n      class=\"vfm vfm--inset\"\n      :class=\"['vfm--fixed', { 'vfm--prevent-none': nonModal }]\"\n      @keydown.esc=\"onEsc\"\n    >\n      <transition v-bind=\"computedOverlayTransition\" v-on=\"overlayListeners\">\n        <div\n          v-if=\"!hideOverlay && visibility.overlay\"\n          class=\"vfm__overlay vfm--overlay vfm--absolute vfm--inset\"\n          :class=\"overlayClass\"\n          :style=\"overlayStyle\"\n        ></div>\n      </transition>\n      <transition v-bind=\"computedTransition\" v-on=\"modalListeners\">\n        <div\n          v-show=\"visibility.modal\"\n          ref=\"vfmContainer\"\n          class=\"vfm__container vfm--absolute vfm--inset vfm--outline-none\"\n          :class=\"classes\"\n          :style=\"styles\"\n          :aria-expanded=\"visibility.modal.toString()\"\n          role=\"dialog\"\n          aria-modal=\"true\"\n          tabindex=\"-1\"\n          @mouseup.self=\"onMouseupContainer\"\n          @mousedown.self=\"onMousedown\"\n        >\n          <div\n            ref=\"vfmContent\"\n            class=\"vfm__content\"\n            :class=\"[contentClass, { 'vfm--prevent-auto': nonModal }]\"\n            :style=\"bindContentStyle\"\n            @mousedown=\"onMousedown(null)\"\n          >\n            <slot :close=\"() => $emit('update:modelValue', false)\" />\n            <div\n              v-if=\"resizeVisible && visibility.modal\"\n              ref=\"vfmResize\"\n              class=\"vfm__resize vfm--absolute vfm--inset vfm--prevent-none vfm--select-none vfm--touch-none\"\n            >\n              <div\n                v-for=\"direction in resizeDirections\"\n                :key=\"direction\"\n                :direction=\"direction\"\n                :class=\"`vfm--resize-${direction}`\"\n                class=\"vfm--absolute vfm--prevent-auto\"\n              ></div>\n            </div>\n          </div>\n        </div>\n      </transition>\n      <slot name=\"append\"></slot>\n    </div>\n  </teleport>\n</template>\n\n<script>\n/* eslint-disable vue/no-mutating-props */\nimport { ref, reactive, onMounted, onBeforeUnmount, computed, nextTick, watch } from 'vue'\nimport { useFocusTrap } from './utils/focusTrap.js'\nimport { useDragResize } from './utils/dragResize.js'\nimport { useLockScroll } from './utils/bodyScrollLock'\nimport { TransitionState, useTransitionState } from './utils/transitionState'\nimport { noop } from './utils/index'\n\nexport default {\n  inheritAttrs: false,\n  props: {\n    name: { type: String, default: null },\n    modelValue: { type: Boolean, default: false },\n    displayDirective: {\n      type: String,\n      default: 'show',\n      validator(val) {\n        return ['if', 'show'].indexOf(val) !== -1\n      }\n    },\n    classes: { type: [String, Object, Array], default: '' },\n    overlayClass: { type: [String, Object, Array], default: '' },\n    contentClass: { type: [String, Object, Array], default: '' },\n    styles: { type: [Object, Array], default: () => ({}) },\n    overlayStyle: { type: [Object, Array], default: () => ({}) },\n    contentStyle: { type: [Object, Array], default: () => ({}) },\n    lockScroll: { type: Boolean, default: true },\n    hideOverlay: { type: Boolean, default: false },\n    clickToClose: { type: Boolean, default: true },\n    escToClose: { type: Boolean, default: false },\n    nonModal: { type: Boolean, default: false },\n    teleportTo: {\n      type: String,\n      default: null\n    },\n    transition: { type: [String, Object], default: 'vfm' },\n    overlayTransition: { type: [String, Object], default: 'vfm' },\n    zIndexAuto: { type: Boolean, default: true },\n    zIndexBase: { type: [String, Number], default: 1000 },\n    zIndex: { type: [Boolean, String, Number], default: false },\n    focusRetain: { type: Boolean, default: true },\n    focusTrap: { type: Boolean, default: false },\n    fitParent: { type: Boolean, default: true },\n    drag: { type: Boolean, default: false },\n    dragSelector: { type: String, default: '' },\n    keepChangedStyle: { type: Boolean, default: false },\n    resize: {\n      type: Boolean,\n      default: false\n    },\n    resizeDirections: {\n      type: Array,\n      default: () => ['t', 'tr', 'r', 'br', 'b', 'bl', 'l', 'tl'],\n      validator: val =>\n        ['t', 'tr', 'r', 'br', 'b', 'bl', 'l', 'tl'].filter(value => val.indexOf(value) !== -1).length === val.length\n    },\n    minWidth: { type: [Number, String], default: 0 },\n    minHeight: { type: [Number, String], default: 0 },\n    maxWidth: { type: [Number, String], default: Infinity },\n    maxHeight: { type: [Number, String], default: Infinity }\n  },\n  emits: [\n    'update:modelValue',\n    'click-outside',\n    'before-open',\n    'opened',\n    '_before-close',\n    'before-close',\n    'closed',\n    '_before-open',\n    '_opened',\n    '_closed',\n    'drag:start',\n    'drag:move',\n    'drag:end',\n    'resize:start',\n    'resize:move',\n    'resize:end'\n  ],\n  setup(props, { emit }) {\n    const uid = Symbol('vfm')\n    const root = ref(null)\n    const vfmContainer = ref(null)\n    const vfmContent = ref(null)\n    const vfmResize = ref(null)\n    const vfmOverlayTransition = ref(null)\n    const vfmTransition = ref(null)\n\n    const modalStackIndex = ref(null)\n\n    const visible = ref(false)\n    const visibility = reactive({\n      modal: false,\n      overlay: false\n    })\n\n    const { state: overlayTransitionState, listeners: overlayListeners } = useTransitionState()\n    const { state: modalTransitionState, listeners: modalListeners } = useTransitionState()\n\n    const _stopEvent = ref(false)\n\n    const { focusTrap } = useFocusTrap({\n      props,\n      vfmContainer,\n      modalTransitionState\n    })\n\n    const { resizeVisible, state, dragResizeStyle, removeDragDown, removeResizeDown } = useDragResize({\n      props,\n      visible,\n      vfmContainer,\n      vfmContent,\n      vfmResize,\n      modalTransitionState,\n      onEvent(e) {\n        emit(state.value, e)\n      }\n    })\n\n    const { handleLockScroll } = useLockScroll({ props, vfmContainer, modalTransitionState })\n\n    const lastMousedownEl = ref(null)\n\n    let resolveToggle = noop\n    let rejectToggle = noop\n\n    const computedOverlayTransition = computed(() => {\n      if (typeof props.overlayTransition === 'string') return { name: props.overlayTransition }\n      return { ...props.overlayTransition }\n    })\n\n    const computedTransition = computed(() => {\n      if (typeof props.transition === 'string') return { name: props.transition }\n      return { ...props.transition }\n    })\n\n    const isComponentReadyToBeDestroyed = computed(() => {\n      return (\n        (props.hideOverlay || overlayTransitionState.value === TransitionState.Leave) &&\n        modalTransitionState.value === TransitionState.Leave\n      )\n    })\n\n    const calculateZIndex = computed(() => {\n      if (props.zIndex === false) {\n        if (props.zIndexAuto) {\n          return +props.zIndexBase + 2 * (modalStackIndex.value || 0)\n        } else {\n          return false\n        }\n      } else {\n        return props.zIndex\n      }\n    })\n\n    const bindStyle = computed(() => {\n      return {\n        ...(calculateZIndex.value !== false && {\n          zIndex: calculateZIndex.value\n        })\n      }\n    })\n\n    const bindContentStyle = computed(() => {\n      let style = [dragResizeStyle.value]\n      Array.isArray(props.contentStyle) ? style.push(...props.contentStyle) : style.push(props.contentStyle)\n      return style\n    })\n\n    watch(\n      () => props.modelValue,\n      value => {\n        if (_stopEvent.value) {\n          _stopEvent.value = false\n          return\n        }\n        mounted()\n        if (!value) {\n          emit('_before-close', createModalEvent({ type: '_before-close' }))\n          if (emitEvent('before-close', true)) {\n            rejectToggle('hide')\n            return\n          }\n          close()\n        }\n      }\n    )\n\n    watch(\n      () => props.hideOverlay,\n      value => {\n        if (props.modelValue && !value) {\n          visibility.overlay = true\n        }\n      }\n    )\n\n    watch(\n      isComponentReadyToBeDestroyed,\n      val => {\n        if (val) {\n          visible.value = false\n          vfmContainer.value.style.display = 'none'\n        }\n      },\n      {\n        flush: 'post'\n      }\n    )\n\n    /**\n     * Side effect about modal transtion state update\n     */\n    watch(modalTransitionState, state => {\n      switch (state) {\n        case TransitionState.Enter:\n          emit('_opened')\n          emit('opened', createModalEvent({ type: 'opened' }))\n          resolveToggle('show')\n          break\n        case TransitionState.Leave:\n          modalStackIndex.value = null\n\n          emit('_closed')\n          emit('closed', createModalEvent({ type: 'closed' }))\n          resolveToggle('hide')\n          break\n      }\n    })\n\n    props.api.modals.push(getModalInfo())\n\n    onMounted(() => {\n      mounted()\n    })\n\n    onBeforeUnmount(() => {\n      close()\n      root?.value?.remove()\n\n      let index = props.api.modals.findIndex(vm => vm.uid === uid)\n\n      props.api.modals.splice(index, 1)\n    })\n\n    function getModalInfo() {\n      return {\n        uid,\n        props,\n        emit,\n        vfmContainer,\n        vfmContent,\n        vfmResize,\n        vfmOverlayTransition,\n        vfmTransition,\n        modalStackIndex,\n        visibility,\n        handleLockScroll,\n        toggle\n      }\n    }\n\n    function mounted() {\n      if (props.modelValue) {\n        emit('_before-open', createModalEvent({ type: '_before-open' }))\n        if (emitEvent('before-open', false)) {\n          rejectToggle('show')\n          return\n        }\n\n        let index = props.api.openedModals.findIndex(vm => vm.uid === uid)\n\n        if (index !== -1) {\n          // if this is already exist in modalStack, delete it\n          props.api.openedModals.splice(index, 1)\n        }\n        props.api.openedModals.push(getModalInfo())\n\n        modalStackIndex.value = props.api.openedModals.length - 1\n\n        handleLockScroll()\n\n        props.api.openedModals\n          .filter(vm => vm.uid !== uid)\n          .forEach(vm => {\n            vm.visibility.overlay = false\n          })\n\n        visible.value = true\n        nextTick(() => {\n          startTransitionEnter()\n        })\n      }\n    }\n\n    function close() {\n      let index = props.api.openedModals.findIndex(vm => vm.uid === uid)\n      if (index !== -1) {\n        // remove this in modalStack\n        props.api.openedModals.splice(index, 1)\n      }\n      if (props.api.openedModals.length > 0) {\n        // If there are still nested modals opened\n        const $_vm = props.api.openedModals[props.api.openedModals.length - 1]\n\n        if ($_vm.props.focusTrap) {\n          nextTick(() => {\n            focusTrap.enable($_vm.vfmContainer.value)\n            focusTrap.firstElement.focus()\n          })\n        }\n\n        if ($_vm.props.focusRetain || $_vm.props.focusTrap) {\n          $_vm.vfmContainer.value.focus()\n        }\n        !$_vm.props.hideOverlay && ($_vm.visibility.overlay = true)\n      }\n      props.drag && removeDragDown()\n      props.resize && removeResizeDown()\n      state.value = null\n\n      startTransitionLeave()\n    }\n\n    function startTransitionEnter() {\n      visibility.overlay = true\n      visibility.modal = true\n    }\n\n    function startTransitionLeave() {\n      visibility.overlay = false\n      visibility.modal = false\n    }\n\n    function onMousedown(e) {\n      lastMousedownEl.value = e?.target\n    }\n\n    function onMouseupContainer() {\n      // skip when the lastMousedownEl didn't equal vfmContainer\n      if (lastMousedownEl.value !== vfmContainer.value) return\n      // skip when state equal 'resize:move'\n      if (state.value === 'resize:move') return\n      emit('click-outside', createModalEvent({ type: 'click-outside' }))\n      props.clickToClose && emit('update:modelValue', false)\n    }\n\n    function onEsc() {\n      if (visible.value && props.escToClose) {\n        emit('update:modelValue', false)\n      }\n    }\n\n    function createModalEvent(eventProps = {}) {\n      return {\n        ref: getModalInfo(),\n        ...eventProps\n      }\n    }\n\n    function emitEvent(eventType, value) {\n      let stopEvent = false\n      const event = createModalEvent({\n        type: eventType,\n        stop() {\n          stopEvent = true\n        }\n      })\n      emit(eventType, event)\n      if (stopEvent) {\n        _stopEvent.value = true\n        nextTick(() => {\n          emit('update:modelValue', value)\n        })\n        return true\n      }\n      return false\n    }\n\n    function toggle(show) {\n      return new Promise((resolve, reject) => {\n        resolveToggle = res => {\n          resolve(res)\n          resolveToggle = noop\n        }\n        rejectToggle = err => {\n          reject(err)\n          rejectToggle = noop\n        }\n        const value = typeof show === 'boolean' ? show : !props.modelValue\n        emit('update:modelValue', value)\n      })\n    }\n\n    return {\n      root,\n      vfmContainer,\n      vfmContent,\n      vfmResize,\n      vfmOverlayTransition,\n      vfmTransition,\n      computedOverlayTransition,\n      computedTransition,\n      overlayListeners,\n      modalListeners,\n      visible,\n      visibility,\n      resizeVisible,\n      calculateZIndex,\n      bindStyle,\n      bindContentStyle,\n      onMousedown,\n      onMouseupContainer,\n      onEsc\n    }\n  }\n}\n</script>\n\n<style scoped>\n.vfm--fixed {\n  position: fixed;\n}\n.vfm--absolute {\n  position: absolute;\n}\n.vfm--inset {\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n}\n.vfm--overlay {\n  background-color: rgba(0, 0, 0, 0.5);\n}\n.vfm--prevent-none {\n  pointer-events: none;\n}\n.vfm--prevent-auto {\n  pointer-events: auto;\n}\n.vfm--outline-none:focus {\n  outline: none;\n}\n.vfm-enter-active,\n.vfm-leave-active {\n  transition: opacity 0.2s;\n}\n.vfm-enter-from,\n.vfm-leave-to {\n  opacity: 0;\n}\n\n.vfm--touch-none {\n  touch-action: none;\n}\n.vfm--select-none {\n  user-select: none;\n}\n\n.vfm--resize-tr,\n.vfm--resize-br,\n.vfm--resize-bl,\n.vfm--resize-tl {\n  width: 12px;\n  height: 12px;\n  z-index: 10;\n}\n\n.vfm--resize-t {\n  top: -6px;\n  left: 0;\n  width: 100%;\n  height: 12px;\n  cursor: ns-resize;\n}\n.vfm--resize-tr {\n  top: -6px;\n  right: -6px;\n  cursor: nesw-resize;\n}\n.vfm--resize-r {\n  top: 0;\n  right: -6px;\n  width: 12px;\n  height: 100%;\n  cursor: ew-resize;\n}\n.vfm--resize-br {\n  bottom: -6px;\n  right: -6px;\n  cursor: nwse-resize;\n}\n.vfm--resize-b {\n  bottom: -6px;\n  left: 0;\n  width: 100%;\n  height: 12px;\n  cursor: ns-resize;\n}\n.vfm--resize-bl {\n  bottom: -6px;\n  left: -6px;\n  cursor: nesw-resize;\n}\n.vfm--resize-l {\n  top: 0;\n  left: -6px;\n  width: 12px;\n  height: 100%;\n  cursor: ew-resize;\n}\n.vfm--resize-tl {\n  top: -6px;\n  left: -6px;\n  cursor: nwse-resize;\n}\n</style>\n","<template>\n  <teleport :to=\"teleportTo\" :disabled=\"!teleportTo\">\n    <div\n      v-if=\"displayDirective !== 'if' || visible\"\n      v-show=\"displayDirective !== 'show' || visible\"\n      v-bind=\"$attrs\"\n      ref=\"root\"\n      :style=\"bindStyle\"\n      class=\"vfm vfm--inset\"\n      :class=\"['vfm--fixed', { 'vfm--prevent-none': nonModal }]\"\n      @keydown.esc=\"onEsc\"\n    >\n      <transition v-bind=\"computedOverlayTransition\" v-on=\"overlayListeners\">\n        <div\n          v-if=\"!hideOverlay && visibility.overlay\"\n          class=\"vfm__overlay vfm--overlay vfm--absolute vfm--inset\"\n          :class=\"overlayClass\"\n          :style=\"overlayStyle\"\n        ></div>\n      </transition>\n      <transition v-bind=\"computedTransition\" v-on=\"modalListeners\">\n        <div\n          v-show=\"visibility.modal\"\n          ref=\"vfmContainer\"\n          class=\"vfm__container vfm--absolute vfm--inset vfm--outline-none\"\n          :class=\"classes\"\n          :style=\"styles\"\n          :aria-expanded=\"visibility.modal.toString()\"\n          role=\"dialog\"\n          aria-modal=\"true\"\n          tabindex=\"-1\"\n          @mouseup.self=\"onMouseupContainer\"\n          @mousedown.self=\"onMousedown\"\n        >\n          <div\n            ref=\"vfmContent\"\n            class=\"vfm__content\"\n            :class=\"[contentClass, { 'vfm--prevent-auto': nonModal }]\"\n            :style=\"bindContentStyle\"\n            @mousedown=\"onMousedown(null)\"\n          >\n            <slot :close=\"() => $emit('update:modelValue', false)\" />\n            <div\n              v-if=\"resizeVisible && visibility.modal\"\n              ref=\"vfmResize\"\n              class=\"vfm__resize vfm--absolute vfm--inset vfm--prevent-none vfm--select-none vfm--touch-none\"\n            >\n              <div\n                v-for=\"direction in resizeDirections\"\n                :key=\"direction\"\n                :direction=\"direction\"\n                :class=\"`vfm--resize-${direction}`\"\n                class=\"vfm--absolute vfm--prevent-auto\"\n              ></div>\n            </div>\n          </div>\n        </div>\n      </transition>\n      <slot name=\"append\"></slot>\n    </div>\n  </teleport>\n</template>\n\n<script>\n/* eslint-disable vue/no-mutating-props */\nimport { ref, reactive, onMounted, onBeforeUnmount, computed, nextTick, watch } from 'vue'\nimport { useFocusTrap } from './utils/focusTrap.js'\nimport { useDragResize } from './utils/dragResize.js'\nimport { useLockScroll } from './utils/bodyScrollLock'\nimport { TransitionState, useTransitionState } from './utils/transitionState'\nimport { noop } from './utils/index'\n\nexport default {\n  inheritAttrs: false,\n  props: {\n    name: { type: String, default: null },\n    modelValue: { type: Boolean, default: false },\n    displayDirective: {\n      type: String,\n      default: 'show',\n      validator(val) {\n        return ['if', 'show'].indexOf(val) !== -1\n      }\n    },\n    classes: { type: [String, Object, Array], default: '' },\n    overlayClass: { type: [String, Object, Array], default: '' },\n    contentClass: { type: [String, Object, Array], default: '' },\n    styles: { type: [Object, Array], default: () => ({}) },\n    overlayStyle: { type: [Object, Array], default: () => ({}) },\n    contentStyle: { type: [Object, Array], default: () => ({}) },\n    lockScroll: { type: Boolean, default: true },\n    hideOverlay: { type: Boolean, default: false },\n    clickToClose: { type: Boolean, default: true },\n    escToClose: { type: Boolean, default: false },\n    nonModal: { type: Boolean, default: false },\n    teleportTo: {\n      type: String,\n      default: null\n    },\n    transition: { type: [String, Object], default: 'vfm' },\n    overlayTransition: { type: [String, Object], default: 'vfm' },\n    zIndexAuto: { type: Boolean, default: true },\n    zIndexBase: { type: [String, Number], default: 1000 },\n    zIndex: { type: [Boolean, String, Number], default: false },\n    focusRetain: { type: Boolean, default: true },\n    focusTrap: { type: Boolean, default: false },\n    fitParent: { type: Boolean, default: true },\n    drag: { type: Boolean, default: false },\n    dragSelector: { type: String, default: '' },\n    keepChangedStyle: { type: Boolean, default: false },\n    resize: {\n      type: Boolean,\n      default: false\n    },\n    resizeDirections: {\n      type: Array,\n      default: () => ['t', 'tr', 'r', 'br', 'b', 'bl', 'l', 'tl'],\n      validator: val =>\n        ['t', 'tr', 'r', 'br', 'b', 'bl', 'l', 'tl'].filter(value => val.indexOf(value) !== -1).length === val.length\n    },\n    minWidth: { type: [Number, String], default: 0 },\n    minHeight: { type: [Number, String], default: 0 },\n    maxWidth: { type: [Number, String], default: Infinity },\n    maxHeight: { type: [Number, String], default: Infinity }\n  },\n  emits: [\n    'update:modelValue',\n    'click-outside',\n    'before-open',\n    'opened',\n    '_before-close',\n    'before-close',\n    'closed',\n    '_before-open',\n    '_opened',\n    '_closed',\n    'drag:start',\n    'drag:move',\n    'drag:end',\n    'resize:start',\n    'resize:move',\n    'resize:end'\n  ],\n  setup(props, { emit }) {\n    const uid = Symbol('vfm')\n    const root = ref(null)\n    const vfmContainer = ref(null)\n    const vfmContent = ref(null)\n    const vfmResize = ref(null)\n    const vfmOverlayTransition = ref(null)\n    const vfmTransition = ref(null)\n\n    const modalStackIndex = ref(null)\n\n    const visible = ref(false)\n    const visibility = reactive({\n      modal: false,\n      overlay: false\n    })\n\n    const { state: overlayTransitionState, listeners: overlayListeners } = useTransitionState()\n    const { state: modalTransitionState, listeners: modalListeners } = useTransitionState()\n\n    const _stopEvent = ref(false)\n\n    const { focusTrap } = useFocusTrap({\n      props,\n      vfmContainer,\n      modalTransitionState\n    })\n\n    const { resizeVisible, state, dragResizeStyle, removeDragDown, removeResizeDown } = useDragResize({\n      props,\n      visible,\n      vfmContainer,\n      vfmContent,\n      vfmResize,\n      modalTransitionState,\n      onEvent(e) {\n        emit(state.value, e)\n      }\n    })\n\n    const { handleLockScroll } = useLockScroll({ props, vfmContainer, modalTransitionState })\n\n    const lastMousedownEl = ref(null)\n\n    let resolveToggle = noop\n    let rejectToggle = noop\n\n    const computedOverlayTransition = computed(() => {\n      if (typeof props.overlayTransition === 'string') return { name: props.overlayTransition }\n      return { ...props.overlayTransition }\n    })\n\n    const computedTransition = computed(() => {\n      if (typeof props.transition === 'string') return { name: props.transition }\n      return { ...props.transition }\n    })\n\n    const isComponentReadyToBeDestroyed = computed(() => {\n      return (\n        (props.hideOverlay || overlayTransitionState.value === TransitionState.Leave) &&\n        modalTransitionState.value === TransitionState.Leave\n      )\n    })\n\n    const calculateZIndex = computed(() => {\n      if (props.zIndex === false) {\n        if (props.zIndexAuto) {\n          return +props.zIndexBase + 2 * (modalStackIndex.value || 0)\n        } else {\n          return false\n        }\n      } else {\n        return props.zIndex\n      }\n    })\n\n    const bindStyle = computed(() => {\n      return {\n        ...(calculateZIndex.value !== false && {\n          zIndex: calculateZIndex.value\n        })\n      }\n    })\n\n    const bindContentStyle = computed(() => {\n      let style = [dragResizeStyle.value]\n      Array.isArray(props.contentStyle) ? style.push(...props.contentStyle) : style.push(props.contentStyle)\n      return style\n    })\n\n    watch(\n      () => props.modelValue,\n      value => {\n        if (_stopEvent.value) {\n          _stopEvent.value = false\n          return\n        }\n        mounted()\n        if (!value) {\n          emit('_before-close', createModalEvent({ type: '_before-close' }))\n          if (emitEvent('before-close', true)) {\n            rejectToggle('hide')\n            return\n          }\n          close()\n        }\n      }\n    )\n\n    watch(\n      () => props.hideOverlay,\n      value => {\n        if (props.modelValue && !value) {\n          visibility.overlay = true\n        }\n      }\n    )\n\n    watch(\n      isComponentReadyToBeDestroyed,\n      val => {\n        if (val) {\n          visible.value = false\n          vfmContainer.value.style.display = 'none'\n        }\n      },\n      {\n        flush: 'post'\n      }\n    )\n\n    /**\n     * Side effect about modal transtion state update\n     */\n    watch(modalTransitionState, state => {\n      switch (state) {\n        case TransitionState.Enter:\n          emit('_opened')\n          emit('opened', createModalEvent({ type: 'opened' }))\n          resolveToggle('show')\n          break\n        case TransitionState.Leave:\n          modalStackIndex.value = null\n\n          emit('_closed')\n          emit('closed', createModalEvent({ type: 'closed' }))\n          resolveToggle('hide')\n          break\n      }\n    })\n\n    props.api.modals.push(getModalInfo())\n\n    onMounted(() => {\n      mounted()\n    })\n\n    onBeforeUnmount(() => {\n      close()\n      root?.value?.remove()\n\n      let index = props.api.modals.findIndex(vm => vm.uid === uid)\n\n      props.api.modals.splice(index, 1)\n    })\n\n    function getModalInfo() {\n      return {\n        uid,\n        props,\n        emit,\n        vfmContainer,\n        vfmContent,\n        vfmResize,\n        vfmOverlayTransition,\n        vfmTransition,\n        modalStackIndex,\n        visibility,\n        handleLockScroll,\n        toggle\n      }\n    }\n\n    function mounted() {\n      if (props.modelValue) {\n        emit('_before-open', createModalEvent({ type: '_before-open' }))\n        if (emitEvent('before-open', false)) {\n          rejectToggle('show')\n          return\n        }\n\n        let index = props.api.openedModals.findIndex(vm => vm.uid === uid)\n\n        if (index !== -1) {\n          // if this is already exist in modalStack, delete it\n          props.api.openedModals.splice(index, 1)\n        }\n        props.api.openedModals.push(getModalInfo())\n\n        modalStackIndex.value = props.api.openedModals.length - 1\n\n        handleLockScroll()\n\n        props.api.openedModals\n          .filter(vm => vm.uid !== uid)\n          .forEach(vm => {\n            vm.visibility.overlay = false\n          })\n\n        visible.value = true\n        nextTick(() => {\n          startTransitionEnter()\n        })\n      }\n    }\n\n    function close() {\n      let index = props.api.openedModals.findIndex(vm => vm.uid === uid)\n      if (index !== -1) {\n        // remove this in modalStack\n        props.api.openedModals.splice(index, 1)\n      }\n      if (props.api.openedModals.length > 0) {\n        // If there are still nested modals opened\n        const $_vm = props.api.openedModals[props.api.openedModals.length - 1]\n\n        if ($_vm.props.focusTrap) {\n          nextTick(() => {\n            focusTrap.enable($_vm.vfmContainer.value)\n            focusTrap.firstElement.focus()\n          })\n        }\n\n        if ($_vm.props.focusRetain || $_vm.props.focusTrap) {\n          $_vm.vfmContainer.value.focus()\n        }\n        !$_vm.props.hideOverlay && ($_vm.visibility.overlay = true)\n      }\n      props.drag && removeDragDown()\n      props.resize && removeResizeDown()\n      state.value = null\n\n      startTransitionLeave()\n    }\n\n    function startTransitionEnter() {\n      visibility.overlay = true\n      visibility.modal = true\n    }\n\n    function startTransitionLeave() {\n      visibility.overlay = false\n      visibility.modal = false\n    }\n\n    function onMousedown(e) {\n      lastMousedownEl.value = e?.target\n    }\n\n    function onMouseupContainer() {\n      // skip when the lastMousedownEl didn't equal vfmContainer\n      if (lastMousedownEl.value !== vfmContainer.value) return\n      // skip when state equal 'resize:move'\n      if (state.value === 'resize:move') return\n      emit('click-outside', createModalEvent({ type: 'click-outside' }))\n      props.clickToClose && emit('update:modelValue', false)\n    }\n\n    function onEsc() {\n      if (visible.value && props.escToClose) {\n        emit('update:modelValue', false)\n      }\n    }\n\n    function createModalEvent(eventProps = {}) {\n      return {\n        ref: getModalInfo(),\n        ...eventProps\n      }\n    }\n\n    function emitEvent(eventType, value) {\n      let stopEvent = false\n      const event = createModalEvent({\n        type: eventType,\n        stop() {\n          stopEvent = true\n        }\n      })\n      emit(eventType, event)\n      if (stopEvent) {\n        _stopEvent.value = true\n        nextTick(() => {\n          emit('update:modelValue', value)\n        })\n        return true\n      }\n      return false\n    }\n\n    function toggle(show) {\n      return new Promise((resolve, reject) => {\n        resolveToggle = res => {\n          resolve(res)\n          resolveToggle = noop\n        }\n        rejectToggle = err => {\n          reject(err)\n          rejectToggle = noop\n        }\n        const value = typeof show === 'boolean' ? show : !props.modelValue\n        emit('update:modelValue', value)\n      })\n    }\n\n    return {\n      root,\n      vfmContainer,\n      vfmContent,\n      vfmResize,\n      vfmOverlayTransition,\n      vfmTransition,\n      computedOverlayTransition,\n      computedTransition,\n      overlayListeners,\n      modalListeners,\n      visible,\n      visibility,\n      resizeVisible,\n      calculateZIndex,\n      bindStyle,\n      bindContentStyle,\n      onMousedown,\n      onMouseupContainer,\n      onEsc\n    }\n  }\n}\n</script>\n\n<style scoped>\n.vfm--fixed {\n  position: fixed;\n}\n.vfm--absolute {\n  position: absolute;\n}\n.vfm--inset {\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n}\n.vfm--overlay {\n  background-color: rgba(0, 0, 0, 0.5);\n}\n.vfm--prevent-none {\n  pointer-events: none;\n}\n.vfm--prevent-auto {\n  pointer-events: auto;\n}\n.vfm--outline-none:focus {\n  outline: none;\n}\n.vfm-enter-active,\n.vfm-leave-active {\n  transition: opacity 0.2s;\n}\n.vfm-enter-from,\n.vfm-leave-to {\n  opacity: 0;\n}\n\n.vfm--touch-none {\n  touch-action: none;\n}\n.vfm--select-none {\n  user-select: none;\n}\n\n.vfm--resize-tr,\n.vfm--resize-br,\n.vfm--resize-bl,\n.vfm--resize-tl {\n  width: 12px;\n  height: 12px;\n  z-index: 10;\n}\n\n.vfm--resize-t {\n  top: -6px;\n  left: 0;\n  width: 100%;\n  height: 12px;\n  cursor: ns-resize;\n}\n.vfm--resize-tr {\n  top: -6px;\n  right: -6px;\n  cursor: nesw-resize;\n}\n.vfm--resize-r {\n  top: 0;\n  right: -6px;\n  width: 12px;\n  height: 100%;\n  cursor: ew-resize;\n}\n.vfm--resize-br {\n  bottom: -6px;\n  right: -6px;\n  cursor: nwse-resize;\n}\n.vfm--resize-b {\n  bottom: -6px;\n  left: 0;\n  width: 100%;\n  height: 12px;\n  cursor: ns-resize;\n}\n.vfm--resize-bl {\n  bottom: -6px;\n  left: -6px;\n  cursor: nesw-resize;\n}\n.vfm--resize-l {\n  top: 0;\n  left: -6px;\n  width: 12px;\n  height: 100%;\n  cursor: ew-resize;\n}\n.vfm--resize-tl {\n  top: -6px;\n  left: -6px;\n  cursor: nwse-resize;\n}\n</style>\n","function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n","<template>\n  <div class=\"modals-container\">\n    <component\n      :is=\"modal.component\"\n      v-for=\"(modal, index) in api.dynamicModals\"\n      :key=\"modal.id\"\n      v-bind=\"modal.bind\"\n      v-model=\"modal.value\"\n      v-on=\"modal.on\"\n      @_beforeClose=\"beforeClose(modal)\"\n      @_closed=\"closed(index, modal)\"\n      @_beforeOpen=\"e => beforeOpen(e, modal, index)\"\n      @_opened=\"modal.opened\"\n    >\n      <template v-for=\"(slot, key) in modal.slots\" #[key] :key=\"key\">\n        <!-- eslint-disable vue/no-v-html -->\n        <div v-if=\"isString(slot)\" v-html=\"slot\"></div>\n        <component :is=\"slot.component\" v-else v-bind=\"slot.bind\" v-on=\"slot.on || {}\" />\n      </template>\n    </component>\n  </div>\n</template>\n\n<script>\nexport default {\n  methods: {\n    slice(index) {\n      this.api.dynamicModals.splice(index, 1)\n    },\n    closed(index, modal) {\n      this.slice(index)\n      modal.closed && modal.closed()\n    },\n    beforeClose(modal) {\n      if (modal.value) {\n        modal?.rejectClose('hide')\n      }\n    },\n    async beforeOpen(e, modal, index) {\n      await this.$nextTick()\n      await this.$nextTick()\n      if (!modal.value) {\n        this.slice(index)\n        modal?.reject('show')\n      }\n    },\n    isString(val) {\n      return typeof val === 'string'\n    }\n  }\n}\n</script>\n","<template>\n  <div class=\"modals-container\">\n    <component\n      :is=\"modal.component\"\n      v-for=\"(modal, index) in api.dynamicModals\"\n      :key=\"modal.id\"\n      v-bind=\"modal.bind\"\n      v-model=\"modal.value\"\n      v-on=\"modal.on\"\n      @_beforeClose=\"beforeClose(modal)\"\n      @_closed=\"closed(index, modal)\"\n      @_beforeOpen=\"e => beforeOpen(e, modal, index)\"\n      @_opened=\"modal.opened\"\n    >\n      <template v-for=\"(slot, key) in modal.slots\" #[key] :key=\"key\">\n        <!-- eslint-disable vue/no-v-html -->\n        <div v-if=\"isString(slot)\" v-html=\"slot\"></div>\n        <component :is=\"slot.component\" v-else v-bind=\"slot.bind\" v-on=\"slot.on || {}\" />\n      </template>\n    </component>\n  </div>\n</template>\n\n<script>\nexport default {\n  methods: {\n    slice(index) {\n      this.api.dynamicModals.splice(index, 1)\n    },\n    closed(index, modal) {\n      this.slice(index)\n      modal.closed && modal.closed()\n    },\n    beforeClose(modal) {\n      if (modal.value) {\n        modal?.rejectClose('hide')\n      }\n    },\n    async beforeOpen(e, modal, index) {\n      await this.$nextTick()\n      await this.$nextTick()\n      if (!modal.value) {\n        this.slice(index)\n        modal?.reject('show')\n      }\n    },\n    isString(val) {\n      return typeof val === 'string'\n    }\n  }\n}\n</script>\n","import VueFinalModalComponent from './VueFinalModal.vue'\nimport ModalsContainerComponent from './ModalsContainer.vue'\nimport { markRaw, reactive, shallowReactive } from 'vue'\n\nexport class ModalInstance {\n  constructor() {\n    const bindApi = component => {\n      const _component = { ...component, props: { ...component.props } }\n      Object.assign(_component.props, {\n        api: { type: Object, default: () => this }\n      })\n      return markRaw(_component)\n    }\n\n    this.modals = []\n    this.openedModals = []\n    this.VueFinalModal = bindApi(VueFinalModalComponent)\n\n    this.dynamicModals = shallowReactive([])\n    this.ModalsContainer = bindApi(ModalsContainerComponent)\n  }\n\n  show(modal, ...args) {\n    switch (typeof modal) {\n      case 'string':\n        return this.toggle(modal, true, ...args)\n      case 'object': {\n        const { show } = this.useModal(modal, args[0])\n        return show()\n      }\n    }\n  }\n\n  hide(...names) {\n    return this.toggle(names, false)\n  }\n\n  hideAll() {\n    return this.hide(...this.openedModals.map(modal => modal.props.name))\n  }\n\n  toggle(name, ...args) {\n    const modals = Array.isArray(name) ? this.get(...name) : this.get(name)\n    return Promise.allSettled(modals.map(modal => modal.toggle(...args)))\n  }\n\n  get(...names) {\n    return this.modals.filter(modal => names.includes(modal.props.name))\n  }\n\n  existModal(options) {\n    return this.dynamicModals.indexOf(options) !== -1\n  }\n\n  useModal(_options) {\n    let options = reactive({\n      value: false,\n      component: this.VueFinalModal,\n      id: Symbol('useModal'),\n      bind: {},\n      slots: {},\n      on: {},\n      ..._options\n    })\n\n    const show = () => {\n      return this.existModal(options)\n        ? Promise.resolve('[Vue Final Modal] modal is already opened')\n        : new Promise((resolve, reject) => {\n            options.value = true\n            options.reject = reject\n            options.opened = () => {\n              resolve('show')\n            }\n            this.dynamicModals.push(options)\n          })\n    }\n\n    const hide = () => {\n      return this.existModal(options)\n        ? new Promise((resolve, reject) => {\n            options.value = false\n            options.rejectClose = reject\n            options.closed = () => {\n              resolve('hide')\n            }\n          })\n        : Promise.resolve('[Vue Final Modal] modal is already closed')\n    }\n\n    return { show, hide, options }\n  }\n}\n\n/**\n * @description Support create multiple modal instance\n */\nexport const createModalInstance = () => {\n  let modalInstance = new ModalInstance()\n  return {\n    $vfm: modalInstance,\n    VueFinalModal: modalInstance.VueFinalModal,\n    ModalsContainer: modalInstance.ModalsContainer,\n    useModal: modalInstance.useModal.bind(modalInstance)\n  }\n}\n\n/**\n * @description Create modal instance by default for directly support `import { $vfm, VueFinalModal, ModalsContainer, useModal } from 'vue-final-modal'`\n */\nconst modalInstance = createModalInstance()\n\nexport const { $vfm, VueFinalModal, ModalsContainer, useModal } = modalInstance\n","import { computed, reactive, ref } from 'vue'\nimport { getPosition, checkPassiveEventSupport } from './dom'\nimport { useEventListener } from '@vueuse/core'\n\nconst SwipeDirection = {\n  UP: 'UP',\n  RIGHT: 'RIGHT',\n  DOWN: 'DOWN',\n  LEFT: 'LEFT',\n  NONE: 'NONE'\n}\n\nexport function useSwipeable(el, { threshold = 50, onSwipeStart, onSwipe, onSwipeEnd, passive = true }) {\n  const coordsStart = reactive({ x: 0, y: 0 })\n  const coordsEnd = reactive({ x: 0, y: 0 })\n\n  const diffX = computed(() => coordsStart.x - coordsEnd.x)\n  const diffY = computed(() => coordsStart.y - coordsEnd.y)\n\n  const { max, abs } = Math\n  const isThresholdExceeded = computed(() => max(abs(diffX.value), abs(diffY.value)) >= threshold)\n  const isSwiping = ref(false)\n\n  const direction = computed(() => {\n    if (!isThresholdExceeded.value) return SwipeDirection.NONE\n\n    if (abs(diffX.value) > abs(diffY.value)) {\n      return diffX.value > 0 ? SwipeDirection.LEFT : SwipeDirection.RIGHT\n    } else {\n      return diffY.value > 0 ? SwipeDirection.UP : SwipeDirection.DOWN\n    }\n  })\n\n  const updateCoordsStart = (x, y) => {\n    coordsStart.x = x\n    coordsStart.y = y\n  }\n\n  const updateCoordsEnd = (x, y) => {\n    coordsEnd.x = x\n    coordsEnd.y = y\n  }\n\n  let listenerOptions\n\n  const isPassiveEventSupported = checkPassiveEventSupport(window?.document)\n\n  if (!passive) {\n    listenerOptions = isPassiveEventSupported ? { passive: false, capture: true } : { capture: true }\n  } else {\n    listenerOptions = isPassiveEventSupported ? { passive: true } : { capture: false }\n  }\n\n  let events\n  function pointerStart(e) {\n    if (listenerOptions.capture && !listenerOptions.passive) {\n      e.preventDefault()\n    }\n    const { x, y } = getPosition(e)\n    updateCoordsStart(x, y)\n    updateCoordsEnd(x, y)\n    onSwipeStart?.(e)\n\n    events = [\n      useEventListener(el, 'mousemove', pointerMove, listenerOptions),\n      useEventListener(el, 'touchmove', pointerMove, listenerOptions),\n      useEventListener(el, 'mouseup', pointerEnd, listenerOptions),\n      useEventListener(el, 'touchend', pointerEnd, listenerOptions),\n      useEventListener(el, 'touchcancel', pointerEnd, listenerOptions)\n    ]\n  }\n\n  function pointerMove(e) {\n    const { x, y } = getPosition(e)\n    updateCoordsEnd(x, y)\n    if (!isSwiping.value && isThresholdExceeded.value) {\n      isSwiping.value = true\n    }\n    if (isSwiping.value) {\n      onSwipe?.(e)\n    }\n  }\n\n  function pointerEnd(e) {\n    if (isSwiping.value) {\n      onSwipeEnd?.(e, direction.value)\n    }\n\n    isSwiping.value = false\n\n    events.forEach(s => s())\n  }\n\n  const stops = [\n    useEventListener(el, 'mousedown', pointerStart, listenerOptions),\n    useEventListener(el, 'touchstart', pointerStart, listenerOptions)\n  ]\n\n  const stop = () => {\n    stops.forEach(s => s())\n    events.forEach(s => s())\n  }\n\n  return {\n    isPassiveEventSupported,\n    isSwiping,\n    direction,\n    coordsStart,\n    coordsEnd,\n    lengthX: diffX,\n    lengthY: diffY,\n    stop\n  }\n}\n","<template>\n  <vue-final-modal\n    v-bind=\"attrs\"\n    class=\"vfm-bottom-sheet\"\n    :transition=\"{\n      'enter-active-class': 'vfmSlideInDown',\n      'leave-active-class': 'vfmSlideOutDown'\n    }\"\n    :lock-scroll=\"lockScroll\"\n    @closed=\"looseFocus\"\n  >\n    <slot name=\"prepend\"></slot>\n    <div\n      ref=\"bottomSheetEl\"\n      class=\"vfm-bottom-sheet-content\"\n      :class=\"[{ 'vfm-transition': !isSwiping }, bottomSheetClass]\"\n      :style=\"[{ transform: `translateY(${-offsetY}px)` }, bottomSheetStyle]\"\n    >\n      <slot></slot>\n    </div>\n    <slot name=\"append\"></slot>\n  </vue-final-modal>\n</template>\n\n<script>\nexport default {\n  inheritAttrs: false\n}\n</script>\n\n<script setup>\nimport { ref, useAttrs, watch } from 'vue'\nimport { useEventListener } from '@vueuse/core'\nimport { useSwipeable } from '../utils/swipeable'\nimport { VueFinalModal } from '../modalInstance'\nimport { looseFocus } from '../utils/dom'\nimport { noop } from '../utils'\n\nfunction clamp(val, min, max) {\n  return val > max ? max : val < min ? min : val\n}\n\nconst LIMIT_DISTANCE = 0.1\nconst LIMIT_SPEED = 300\n\nconst props = defineProps({\n  bottomSheetClass: { type: [String, Object], default: '' },\n  bottomSheetStyle: { type: [Object], default: () => ({}) },\n  swipeToCloseDirection: {\n    type: String,\n    default: '',\n    validator(val) {\n      return ['', 'DOWN'].includes(val) !== -1\n    }\n  },\n  threshold: { type: Number, default: 30 },\n  lockScroll: { type: Boolean, default: false }\n})\n\nconst attrs = useAttrs()\nconst emit = defineEmits()\n\nconst bottomSheetEl = ref(null)\nconst offsetY = ref(0)\nconst isCollapsed = ref(true)\nlet stopSelectionChange = noop\nlet shouldCloseModal = true\nlet swipeStart = null\nlet allowSwipe = false\n\nconst { lengthY, direction, isSwiping } = useSwipeable(bottomSheetEl, {\n  threshold: props.threshold,\n  onSwipeStart(e) {\n    stopSelectionChange = useEventListener(document, 'selectionchange', () => {\n      isCollapsed.value = window.getSelection().isCollapsed\n    })\n    swipeStart = new Date().getTime()\n    allowSwipe = canSwipe(e.target)\n  },\n  onSwipe() {\n    if (!allowSwipe) return\n    if (direction.value === props.swipeToCloseDirection) {\n      if (!isCollapsed.value) return\n      offsetY.value = -clamp(Math.abs(lengthY.value), 0, bottomSheetEl.value.offsetHeight) + props.threshold\n    }\n  },\n  onSwipeEnd(event, direction) {\n    stopSelectionChange()\n    if (!isCollapsed.value) {\n      isCollapsed.value = true\n      return\n    }\n\n    const swipeEnd = new Date().getTime()\n\n    const validDirection = direction === props.swipeToCloseDirection\n    const validDistance = Math.abs(lengthY.value) > LIMIT_DISTANCE * bottomSheetEl.value.offsetHeight\n    const validSpeed = swipeEnd - swipeStart <= LIMIT_SPEED\n\n    if (shouldCloseModal && allowSwipe && validDirection && (validDistance || validSpeed)) {\n      // eslint-disable-next-line vue/require-explicit-emits\n      emit('update:modelValue', false)\n      return\n    }\n\n    offsetY.value = 0\n  }\n})\n\nwatch(\n  () => attrs.modelValue,\n  val => {\n    if (val) {\n      offsetY.value = 0\n    }\n  }\n)\n\nwatch(\n  () => isCollapsed.value,\n  val => {\n    if (!val) {\n      offsetY.value = 0\n    }\n  }\n)\n\nwatch(\n  () => offsetY.value,\n  (newValue, oldValue) => {\n    if (props.swipeToCloseDirection === 'DOWN') {\n      shouldCloseModal = newValue < oldValue\n    }\n  }\n)\n\nfunction canSwipe(target) {\n  const allow = target.scrollTop === 0\n  if (target === bottomSheetEl.value) {\n    return allow\n  } else {\n    return allow && canSwipe(target.parentElement)\n  }\n}\n</script>\n\n<style lang=\"scss\">\n.vfm-bottom-sheet {\n  .vfm-bottom-sheet-content {\n    position: absolute;\n    bottom: 0;\n    width: 100%;\n    max-height: 90%;\n    overflow-y: auto;\n    border-top-left-radius: 12px;\n    border-top-right-radius: 12px;\n  }\n\n  .vfm-transition {\n    transition-property: transform;\n    transition-duration: 250ms;\n  }\n\n  @keyframes vfmSlideInDown {\n    from {\n      transform: translate3d(0, 100%, 0);\n    }\n\n    to {\n      transform: translate3d(0, 0, 0);\n    }\n  }\n\n  .vfmSlideInDown {\n    animation-name: vfmSlideInDown;\n    animation-duration: 0.3s;\n  }\n\n  @keyframes vfmSlideOutDown {\n    from {\n      transform: translate3d(0, 0, 0);\n    }\n\n    to {\n      transform: translate3d(0, 100%, 0);\n    }\n  }\n\n  .vfmSlideOutDown {\n    animation-name: vfmSlideOutDown;\n    animation-duration: 0.3s;\n  }\n}\n</style>\n","<template>\n  <vue-final-modal\n    v-bind=\"attrs\"\n    class=\"vfm-full-screen\"\n    :hide-overlay=\"hideOverlay\"\n    :transition=\"transition\"\n    :content-style=\"[{ transform: `translateX(${-offsetX}px)` }]\"\n    :content-class=\"{ 'vfm-transition': !isSwiping }\"\n    :lock-scroll=\"lockScroll\"\n    @closed=\"looseFocus\"\n  >\n    <div ref=\"modalContent\" class=\"vfm-full-screen-content\" :class=\"fullScreenClass\" :style=\"fullScreenStyle\">\n      <slot></slot>\n      <div\n        v-if=\"showSwipeBanner\"\n        ref=\"swipeBannerContainerEl\"\n        class=\"vfm-swipe-banner-container\"\n        @touchstart=\"e => onTouchStartSwipeBanner(e)\"\n      >\n        <slot name=\"swipe-banner\">\n          <div class=\"vfm-swipe-banner-back\" @touchstart=\"e => closeDirection === 'LEFT' && e.preventDefault()\" />\n          <div class=\"vfm-swipe-banner-forward\" @touchstart=\"e => closeDirection === 'RIGHT' && e.preventDefault()\" />\n        </slot>\n      </div>\n      <div\n        v-else-if=\"!showSwipeBanner && preventNavigationGestures\"\n        class=\"vfm-swipe-banner-container\"\n        @touchstart=\"e => onTouchStartSwipeBanner(e)\"\n      >\n        <div class=\"vfm-swipe-banner-back\" @touchstart=\"e => closeDirection === 'LEFT' && e.preventDefault()\" />\n        <div class=\"vfm-swipe-banner-forward\" @touchstart=\"e => closeDirection === 'RIGHT' && e.preventDefault()\" />\n      </div>\n    </div>\n  </vue-final-modal>\n</template>\n\n<script>\nexport default {\n  inheritAttrs: false\n}\n</script>\n\n<script setup>\nimport { computed, ref, useAttrs, watch } from 'vue'\nimport { useEventListener } from '@vueuse/core'\nimport { useSwipeable } from '../utils/swipeable'\nimport { VueFinalModal } from '../modalInstance'\nimport { looseFocus } from '../utils/dom'\nimport { noop } from '../utils'\n\nfunction clamp(val, min, max) {\n  return val > max ? max : val < min ? min : val\n}\n\nconst LIMIT_DISTANCE = 0.1\nconst LIMIT_SPEED = 300\n\nconst props = defineProps({\n  fullScreenClass: { type: [String, Object, Array], default: '' },\n  fullScreenStyle: { type: [Object, Array], default: () => ({}) },\n  transition: { type: [String, Object], default: 'vfm' },\n  canSwipeToClose: { type: Boolean, default: false },\n  closeDirection: {\n    type: String,\n    default: '',\n    validator(val) {\n      return ['', 'RIGHT', 'LEFT'].includes(val) !== -1\n    }\n  },\n  threshold: { type: Number, default: 30 },\n  lockScroll: { type: Boolean, default: false },\n  hideOverlay: { type: Boolean, default: true },\n  showSwipeBanner: { type: Boolean, default: false },\n  preventNavigationGestures: { type: Boolean, default: undefined }\n})\n\nconst attrs = useAttrs()\nconst emit = defineEmits()\n\nconst modalContent = ref(null)\nconst swipeBannerContainerEl = ref()\nconst swipeEl = computed(() => (props.showSwipeBanner ? swipeBannerContainerEl.value : modalContent.value))\n\nconst offsetX = ref(0)\nconst isCollapsed = ref(true)\nlet stopSelectionChange = noop\nlet shouldCloseModal = true\nlet swipeStart = null\nlet allowSwipe = false\n\nconst transition = computed(() => {\n  if (props.closeDirection) {\n    return {\n      'enter-active-class': props.closeDirection === 'RIGHT' ? 'vfmSlideInRight' : 'vfmSlideInLeft',\n      'leave-active-class': props.closeDirection === 'RIGHT' ? 'vfmSlideOutRight' : 'vfmSlideOutLeft'\n    }\n  } else {\n    return props.transition\n  }\n})\n\nconst { lengthX, direction, isSwiping } = props.canSwipeToClose\n  ? useSwipeable(swipeEl, {\n      threshold: props.threshold,\n      onSwipeStart(e) {\n        stopSelectionChange = useEventListener(document, 'selectionchange', () => {\n          isCollapsed.value = window.getSelection().isCollapsed\n        })\n        swipeStart = new Date().getTime()\n        allowSwipe = canSwipe(e.target)\n      },\n      onSwipe() {\n        if (!allowSwipe) return\n        if (direction.value === props.closeDirection) {\n          if (!isCollapsed.value) return\n          const _offsetX = clamp(Math.abs(lengthX.value), 0, modalContent.value.offsetWidth) - props.threshold\n          offsetX.value = props.closeDirection === 'RIGHT' ? -_offsetX : _offsetX\n        }\n      },\n      onSwipeEnd(event, direction) {\n        stopSelectionChange()\n        if (!isCollapsed.value) {\n          isCollapsed.value = true\n          return\n        }\n\n        const swipeEnd = new Date().getTime()\n\n        const validDirection = direction === props.closeDirection\n        const validDistance = Math.abs(lengthX.value) > LIMIT_DISTANCE * modalContent.value.offsetWidth\n        const validSpeed = swipeEnd - swipeStart <= LIMIT_SPEED\n\n        if (shouldCloseModal && allowSwipe && validDirection && (validDistance || validSpeed)) {\n          // eslint-disable-next-line vue/require-explicit-emits\n          emit('update:modelValue', false)\n          return\n        }\n\n        offsetX.value = 0\n      }\n    })\n  : {}\n\nwatch(\n  () => attrs.modelValue,\n  val => {\n    if (val) {\n      offsetX.value = 0\n    }\n  }\n)\n\nwatch(\n  () => isCollapsed.value,\n  val => {\n    if (!val) {\n      offsetX.value = 0\n    }\n  }\n)\n\nwatch(\n  () => offsetX.value,\n  (newValue, oldValue) => {\n    if (!props.canSwipeToClose) return\n    if (props.closeDirection === 'RIGHT') {\n      shouldCloseModal = newValue < oldValue\n    } else if (props.closeDirection === 'LEFT') {\n      shouldCloseModal = newValue > oldValue\n    }\n  }\n)\n\nfunction canSwipe(target) {\n  const tagName = target?.tagName\n  if (!tagName || ['INPUT', 'TEXTAREA'].includes(tagName)) return false\n\n  const allow = target?.scrollLeft === 0\n  if (target === swipeEl.value) {\n    return allow\n  } else {\n    return allow && canSwipe(target.parentElement)\n  }\n}\n\nfunction onTouchStartSwipeBanner(e) {\n  if (props.preventNavigationGestures) {\n    e.preventDefault()\n  }\n}\n</script>\n\n<style lang=\"scss\">\n.vfm-full-screen {\n  .vfm-full-screen-content {\n    width: 100%;\n    height: 100%;\n    overflow-y: auto;\n  }\n\n  .vfm-swipe-banner-back,\n  .vfm-swipe-banner-forward {\n    position: fixed;\n    top: 0;\n    bottom: 0;\n    width: 27px;\n    z-index: 10;\n  }\n  .vfm-swipe-banner-back {\n    left: 0;\n  }\n  .vfm-swipe-banner-forward {\n    right: 0;\n  }\n\n  .vfm-transition {\n    transition-property: transform;\n    transition-duration: 0.3s;\n  }\n\n  .vfm__content {\n    width: 100%;\n    height: 100%;\n  }\n\n  @keyframes vfmSlideInLeft {\n    from {\n      transform: translate3d(-100%, 0, 0);\n    }\n\n    to {\n      transform: translate3d(0, 0, 0);\n    }\n  }\n\n  .vfmSlideInLeft {\n    animation-name: vfmSlideInLeft;\n    animation-duration: 0.3s;\n  }\n\n  @keyframes vfmSlideInRight {\n    from {\n      transform: translate3d(100%, 0, 0);\n    }\n\n    to {\n      transform: translate3d(0, 0, 0);\n    }\n  }\n\n  .vfmSlideInRight {\n    animation-name: vfmSlideInRight;\n    animation-duration: 0.3s;\n  }\n\n  @keyframes vfmSlideOutLeft {\n    from {\n      transform: translate3d(0, 0, 0);\n    }\n\n    to {\n      transform: translate3d(-100%, 0, 0);\n    }\n  }\n\n  .vfmSlideOutLeft {\n    animation-name: vfmSlideOutLeft;\n    animation-duration: 0.3s;\n  }\n\n  @keyframes vfmSlideOutRight {\n    from {\n      transform: translate3d(0, 0, 0);\n    }\n\n    to {\n      transform: translate3d(100%, 0, 0);\n    }\n  }\n\n  .vfmSlideOutRight {\n    animation-name: vfmSlideOutRight;\n    animation-duration: 0.3s;\n  }\n}\n</style>\n"],"names":["TransitionState","useTransitionState","state","ref","listeners","beforeEnter","value","afterEnter","beforeLeave","afterLeave","isFocused","element","document","activeElement","FocusTrap","constructor","this","root","elements","onKeyDown","bind","lastElement","length","firstElement","isEnabled","event","key","keyCode","isTabPressed","shiftKey","focus","preventDefault","enable","selector","querySelectorAll","addEventListener","disable","removeEventListener","focusTrap","useFocusTrap","props","vfmContainer","modalTransitionState","watch","focusRetain","enabled","noop","looseFocus","body","blur","getPosition","e","clientX","x","clientY","y","targetTouches","pointerType","down","pc","m","move","up","addListener","type","el","callback","passive","removeListener","resizeCursor","t","tr","r","br","b","bl","l","tl","clamp","min","num","max","Math","trimPx","distance","Number","replace","useDragResize","visible","vfmContent","vfmResize","onEvent","resizeVisible","dragResizeStyle","pointerDown","stopPropagation","STATE_RESIZE","STATE_DRAG","direction","target","getAttribute","_state","dragSelector","includes","validDragElement","rectContainer","getBoundingClientRect","rectContent","isAbsolute","window","getComputedStyle","position","top","left","limit","fitParent","absolute","minTop","minLeft","maxTop","height","maxLeft","width","relative","bottom","right","resetBodyCursor","cacheStyle","style","setStyle","moving","offset","setOffset","dir","offsetAxis","axis","edge","minEdge","getEdge","maxEdge","getOffsetAxis","edgeName","getDirectionInfo","isPositive","rectContentEdge","positionOffset","EdgeName","s","charAt","toUpperCase","slice","directions","_offset","split","forEach","directionInfo","getResizeOffset","margin","touchAction","transform","end","setTimeout","addDragDown","removeDragDown","addResizeDown","nextTick","removeResizeDown","val","drag","resize","keepChangedStyle","hasPassiveEvents","passiveTestOptions","isIosDevice","navigator","platform","test","maxTouchPoints","previousBodyOverflowSetting","previousBodyPaddingRight","locks","documentListenerAdded","initialClientY","hasAnyScrollableEl","delta","path","push","classList","contains","parentElement","composedPath","nodeType","Node","ELEMENT_NODE","overflowY","scrollHeight","clientHeight","hasScrollbar","scrollTop","shouldScroll","allowTouchMove","some","rawEvent","touches","disableBodyScroll","targetElement","options","console","error","lock","ontouchstart","ontouchmove","isTargetElementTotallyScrolled","handleScroll","undefined","reserveScrollBarGap","scrollBarGap","innerWidth","documentElement","clientWidth","computedBodyPaddingRight","parseInt","getPropertyValue","paddingRight","overflow","setOverflowHidden","enableBodyScroll","filter","useLockScroll","handleLockScroll","modelValue","lockScroll","onBeforeUnmount","inheritAttrs","name","String","default","Boolean","displayDirective","validator","indexOf","classes","Object","Array","overlayClass","contentClass","styles","overlayStyle","contentStyle","hideOverlay","clickToClose","escToClose","nonModal","teleportTo","transition","overlayTransition","zIndexAuto","zIndexBase","zIndex","resizeDirections","minWidth","minHeight","maxWidth","Infinity","maxHeight","emits","setup","emit","uid","Symbol","vfmOverlayTransition","vfmTransition","modalStackIndex","visibility","reactive","modal","overlay","overlayTransitionState","overlayListeners","modalListeners","_stopEvent","lastMousedownEl","resolveToggle","rejectToggle","computedOverlayTransition","computed","computedTransition","isComponentReadyToBeDestroyed","calculateZIndex","bindStyle","bindContentStyle","isArray","getModalInfo","toggle","mounted","createModalEvent","emitEvent","index","api","openedModals","findIndex","vm","splice","close","$_vm","eventProps","eventType","stopEvent","stop","show","Promise","resolve","reject","res","err","display","flush","modals","onMounted","remove","onMousedown","onMouseupContainer","onEsc","class","styleInject","css","insertAt","head","getElementsByTagName","createElement","firstChild","insertBefore","appendChild","styleSheet","cssText","createTextNode","_createBlock","to","$props","disabled","$setup","_createElementBlock","_mergeProps","_ctx","onKeydown","_createVNode","_toHandlers","_createElementVNode","toString","role","tabindex","onMouseup","_renderSlot","_hoisted_2","methods","dynamicModals","closed","beforeClose","rejectClose","beforeOpen","$nextTick","isString","_hoisted_1","component","id","on","on_beforeClose","$options","on_closed","on_beforeOpen","on_opened","opened","slots","slot","_createCommentVNode","innerHTML","ModalInstance","bindApi","_component","assign","markRaw","VueFinalModal","VueFinalModalComponent","shallowReactive","ModalsContainer","ModalsContainerComponent","args","useModal","hide","names","hideAll","map","get","allSettled","existModal","_options","createModalInstance","modalInstance","$vfm","SwipeDirection","useSwipeable","threshold","onSwipeStart","onSwipe","onSwipeEnd","coordsStart","coordsEnd","diffX","diffY","abs","isThresholdExceeded","isSwiping","updateCoordsEnd","listenerOptions","isPassiveEventSupported","supportsPassive","optionsBlock","checkPassiveEventSupport","events","pointerStart","capture","updateCoordsStart","useEventListener","pointerMove","pointerEnd","stops","lengthX","lengthY","attrs","useAttrs","bottomSheetEl","offsetY","isCollapsed","stopSelectionChange","shouldCloseModal","swipeStart","allowSwipe","getSelection","Date","getTime","canSwipe","swipeToCloseDirection","offsetHeight","swipeEnd","validDirection","validDistance","allow","newValue","oldValue","modalContent","swipeBannerContainerEl","swipeEl","showSwipeBanner","offsetX","closeDirection","canSwipeToClose","_offsetX","offsetWidth","tagName","scrollLeft","onTouchStartSwipeBanner","preventNavigationGestures"],"mappings":"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"}